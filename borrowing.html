<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Borrowed Books</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<style>
body {margin:0; font-family:'Times New Roman', Times, serif; background:#f7f7f7;}

.words {
    background:#002a01;
    padding:15px;
    display:flex;
    align-items:flex-start;
}
.words img{width:100px; height:100px;}
.words h1,.words p{color:white;margin:0;}
.header1{margin-left:15px;}

.nav1{
    background:#006800;
    display:flex;
    align-items:center;
    padding:10px;
}
.nav1 a{
    color:white;
    text-decoration:none;
    font-weight:bold;
    margin-right:20px;
}
.left a:hover{
    color:rgb(0, 0, 0);
}
.nav1 .right{
    margin-left:auto;
}
.right a:hover{
    color: red;
}

.container{
    max-width:1200px;
    margin:30px auto;
    padding:0 20px;
}
.book-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:20px;
}
.book-card{
    background:#f5f5f5;
    border-radius:10px;
    padding:15px;
    text-align:center;
    transition:.3s;
    cursor:pointer;
}
.book-card:hover{
    background:#dcdcdc;
    transform:scale(1.03);
}
.book-card img{
    width:150px;
    height:200px;
    object-fit:cover;
    border-radius:8px;
}
.status{
    display:inline-block;
    margin-top:8px;
    padding:5px 10px;
    border-radius:6px;
    font-weight:bold;
}
.available{color:green; border:1px solid green;}
.overdue{color:red; border:1px solid red;}
.due-soon{color:orange; border:1px solid orange;}
.on-loan{color:#006800; border:1px solid #006800;}
.pending{color:blue; border:1px solid blue;}

.pay-btn{
    margin-top:10px;
    padding:8px 12px;
    background:#ff6600;
    color:white;
    border:none;
    cursor:pointer;
    border-radius:6px;
    font-size:14px;
    font-weight:bold;
}
.pay-btn:hover{
    background:#cc5200;
}
</style>
</head>
<body>

<!-- Header -->
<div class="words">
    <img src="LMS IMG/logo.jpg" alt="Logo">
    <div class="header1">
        <h1>Mountain Province State University</h1>
        <p>Bontoc Campus</p>
        <p>Library</p>
    </div>
</div>

<!-- Navigation -->
<nav class="nav1">
    <div class="left">
    <a href="home.html">HOME</a>
    <a href="bookpage.html">BOOK</a>
    <a href="borrowing.html">BOOKS BORROWED</a>
    </div>
    <div class="right">
        <a href="index.html">LOG OUT</a>
    </div>
</nav>

<div class="container">
    <h2 style="text-align:center; margin-bottom:20px;">My Borrowed Books</h2>
    <div class="book-grid" id="borrowedBooksContainer"></div>
    <p id="emptyMessage" style="text-align:center; color:#555; display:none;">No borrowed books currently.</p>
</div>

<script>
// Sample borrowed books
const borrowedBooks = [
    {title:"Criminal Investigation", author:"Charles R. Swanson", image:"bookpage/crim inves.jpg", due:"2025-11-18"},
    {title:"Programming Fundamentals", author:"Joyce Farrell", image:"bookpage/pf.png", due:"2025-11-22"},
    {title:"Medical-Surgical Nursing", author:"Ignatavicius & Workman", image:"bookpage/msn.jpg", due:"2025-11-16"},
    {title:"Introduction to IT", author:"John Doe", image:"it/it1.jpg", status:"pending"}
];

function getBookStatus(book){
    if(book.status === "pending"){
        return { text:"Pending Approval", class:"pending", overdue:false };
    }

    if(!book.due) return { text:"On Loan", class:"on-loan", overdue:false };

    const today = new Date();
    const due = new Date(book.due);
    const diffTime = due - today;
    const diffDays = Math.ceil(diffTime / (1000*60*60*24));

    if(diffDays < 0){
        return { text:`OVERDUE (${Math.abs(diffDays)} day${Math.abs(diffDays)!==1?'s':''})`, class:"overdue", overdue:true };
    } else if(diffDays === 0){
        return { text:"DUE TODAY", class:"due-soon", overdue:false };
    } else if(diffDays <= 3){
        return { text:`Due in ${diffDays} day${diffDays!==1?'s':''}`, class:"due-soon", overdue:false };
    } else {
        return { text:"On Loan", class:"on-loan", overdue:false };
    }
}

function renderBorrowedBooks(){
    const container = document.getElementById('borrowedBooksContainer');
    const emptyMessage = document.getElementById('emptyMessage');

    if(borrowedBooks.length === 0){
        emptyMessage.style.display = "block";
        return;
    }

    borrowedBooks.forEach((book,index)=>{
        const status = getBookStatus(book);
        const card = document.createElement('div');
        card.className = 'book-card';
        let dueDate = book.due ? new Date(book.due).toLocaleDateString('en-US', {year:'numeric', month:'short', day:'numeric'}) : "N/A";
        card.innerHTML = `
            <img src="${book.image}" alt="${book.title}">
            <h4>${book.title}</h4>
            <p><b>Author:</b> ${book.author}</p>
            <p><b>Due Date:</b> ${dueDate}</p>
            <span class="status ${status.class}">${status.text}</span>
            ${status.overdue? `<button class="pay-btn" onclick="payFine(${index})">Pay Fine</button>` : ''}
        `;
        container.appendChild(card);
    });
}

// Redirect to payment page
function payFine(index){
    const book = borrowedBooks[index];
    const url = `payment.html?title=${encodeURIComponent(book.title)}&due=${book.due}`;
    window.location.href = url;
}

renderBorrowedBooks();
</script>
</body>
</html>
